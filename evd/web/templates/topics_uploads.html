{% extends "base.html" %} {% load tags %} {% load filters %} {% block head_title %}eVidyaloka - Content Admin{% endblock %} {% block head_styles %} {{ block.super }}
<link rel="stylesheet" href="/static/css/lr_bulk.css">
<style>
    .inner {
        width: 100%;
    }
      .app-new-form-label form{
        border: none !important;
      }
      .app-new-panel{
        display: flex;
        justify-content: center !important;
      }
</style>
<link rel="stylesheet" href="/static/css/tables-min.css">
<link rel="stylesheet" href="/static/css/jquery-ui.css" /> {% endblock %}{% block body_container %}
<div style='background-color:#bee5be;' id='main'>
    <div class='hdr'>
        <h2> Bulk Upload - Topics </h2>
    </div>
    <div class='panel app-new-panel' style="height: 138px;">
        <select name="sel_board" id="sel_board" style="position: relative;top: 15px; width: 160px;">
            <option value="" >--Select the Board--</option>
            {% for board in board_list %}
            <option value="{{board}}" >{{board}}</option>
            {% endfor %}
        </select>

        <select id='sel_courses' multiple name="sel_courses[]" style="position: relative;top: -17px; height: 101px;" > 
            <option value=""> --Select Courses-- </option>
        </select>

        <a href='' data-keyboard="false" data-backdrop="static" data-toggle='modal'><button class='btn btn-sml' id='popup' style="position: relative;top: 25px; left: 6px;">Submit</button></a>
    </div>
    <div id=msg_box1>
        <p style="position: relative;
        left: 28%;
        height: 27px;
        font-weight: 600;">Press Ctrl and select next Courses for multi select</p>

    </div>
    <div id='msg_box'>
        <p></p>
    </div>

    <div class='instr'>
        <p style='text-align:center;font-size:20px;padding-bottom:10px;margin-left:415px;display:inline-block;'>Instructions</p>
        <a href='/lr_bulk_upload/' id='bck' style='display:none;float:right;'><button  style='margin-top:-4px;height:31px;font-size:13px;margin-right:20px;' class='btn'>Go Back</button></a>
        <div class='cnt' id='cnt1'>
            <div style='float:left;display:inline;'>
                <p class='one'>✪ Choose your Board to fetch courses.</p><br>
                <p class='one'>✪ Select the Courses and Click on"<span class='high'>Submit</span>" button to Download and Upload Topics.</p><br>
            </div>
            <div style='float:right;display:inline;margin-right:36px;margin-top:-5px;'>
                <p>✪ Your next 3 steps ahead :</p>
                <img src='/static/images/upload_steps.jpg' />
            </div>
        </div>
    </div>
</div>


<div id='upload-modal' class='modal hide'>
    <div class="header">
        <p>Topics Upload</p>
        <a class="close" data-dismiss="modal" style="float:right;cursor:pointer;position:absolute;top:0px;right:0px;">X</a>
    </div>
    <div style='height:100%;background-color:white;padding:20px'>
        <p style='display:inline'>Download the template from here :</p>
        <a href='/download_topics/' style="float:right"><button  class='btn btn-sml' style='display:inline; margin-left:10px;font-size:12px;width:80px;' id=''> Download</button></a><br><br>
        <hr><br>
        <p style='display:inline'>Upload the file after filling Topics Details here :</p>
        <div class="app-new-form-label">
          <form action="/import-topics/" method="post" enctype="multipart/form-data">
            {% csrf_token %}          
        <div style='padding:20px 0px 10px 30px;'>
            <p style='display:inline-block;'>Browse for the file : </p>
            <input type='file' id='file' style='width:80%;height:30px' name='file' /><br><br>
            <div style="text-align:center">
                <button type="submit" class='btn btn-sml' style='display:inline-block;font-size:12px;width:80px;' class='upl' id=''>
            Upload</button>
            </div>
        </div>
        </form>
        </div>
    </div>
    <p id='err_msg' style='padding:10px;text-align:center;color:red;display:none'></p>
    <div align="center" class="uploadFlagDiv" style="padding-bottom:17px;display:none;">
        <button class='btn btn-sml uploadFlag' style='display:inline-block;font-size:12px;width:80px;
             		margin-right:13%;'>Yes</button>
        <button class='btn btn-sml uploadFlagNo' style='display:inline-block;font-size:12px;
            		width:80px;'>No</button>
        <input type="hidden" value="" id="uploadFlagId" />
    </div>
</div>

{% endblock %} {% block bottom_scripts %} {{ block.super }}
<script type="text/javascript" src="/static/js/jquery-ui.min.js"></script>
<script type="text/javascript">
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(function() {
        var board = $('#sel_board');
        var courses = $('#sel_courses');
        var topics = $('#sel_topics');
        var subtopics = $('#sel_subtopics');

        board.change(function() {
            var board_name = board.val();
            $.ajax({
                url: '/my_topic_ajax/',
                data: {'board_name': board_name},
                dataType: 'json',
                success: function(response) {
                    var stateSelect = $('#sel_courses');
                    stateSelect.empty();
                    stateSelect.append('<option value="">---Select the course---</option>');
                    $.each(response.courses, function(index, course) {
                        stateSelect.append('<option value="' + course.id + '">' + course.grade + 'th ' + course.subject + '</option>');
                    });
                }
            });
        });

        courses.change(function() {
            var board_name = board.val();
            var course_id = courses.val();
            console.log(course_id)
            $.ajax({
                url: '/my_topic_ajax/',
                data: {'board_name': board_name, 'course_id': course_id},
                dataType: 'json',
                success: function(response) {
                    var stateSelect = $('#sel_topics');
                    stateSelect.empty();
                    stateSelect.append('<option value="">---Select the topicsssss---</option>');
                    console.log(response.topics)
                    $.each(response.topics, function(index, topic) {
                        stateSelect.append('<option style="background-color:rgb(132, 252, 121);" value="' + topic.id + '">' + topic.id + ' - ' + topic.title + '</option>');
                    });
                }
            });
        });

        topics.change(function() {
            var board_name = board.val();
            var course_id = courses.val();
            var topic_id = topics.val();
            $.ajax({
                url: '/my_topic_ajax/',
                data: {'board_name': board_name, 'course_id': course_id, 'topic_id': topic_id},
                success: function(response) {
                    var stateSelect = $('#sel_subtopics');
                    stateSelect.empty();
                    stateSelect.append('<option value="">---Select the subtopicsssss---</option>');
                    // console.log(response.subtopics)
                    $.each(response.subtopics, function(index, subtopic) {
                        stateSelect.append('<option style="background-color:rgb(132, 252, 121);" value="' + subtopic.id + '">' + subtopic.id + ' - ' + subtopic.name + '</option>');
                    });
                }
            });
        });
    });
</script>
<script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
<!-- <script>

    $(document).ready(function() {
      $('#sel_board').change(function() {
        var board = $(this).val();
        if (board) {
          $.ajax({
            url: '/load_courses/',
            data: {
              'board': board
            },
            dataType: 'json',
            success: function(response) {
              var stateSelect = $('#sel_courses');
              console.log(stateSelect)
              stateSelect.empty();
              stateSelect.append('<option value="">---Select the Course---</option>');
              $.each(response.courses, function(index, course) {
                stateSelect.append('<option value="' + course.id + '">' + course.id +  ' ---' + course.grade + 'th ' + course.subject + '</option>');
              });
            }
          });
        } else {
          var stateSelect = $('#sel_courses');
          stateSelect.empty();
          stateSelect.append('<option value="">Select a board first</option>');
        }
      });
    });

    $(document).ready(function() {
      $('#sel_courses').change(function() {
        var courseId = $(this).val();
        // console.log("$$$$$",courseId)
        if (courseId) {
          $.ajax({
            url: '/load_topics/',
            data: {
              'courseId': courseId
            },
            dataType: 'json',
            success: function(response) {
            // console.log(response)
              var stateSelect = $('#sel_topics');
              stateSelect.empty();
              stateSelect.append('<option value="">---Select the Topics---</option>');
            //   console.log(response.topics)
              $.each(response.topics, function(index, topic) {
                stateSelect.append('<option value="' + topic.id + '">' + topic.id + '-' + topic.title + '</option>');
              });
            }
          });
        } else {
          var stateSelect = $('#sel_topics');
          stateSelect.empty();
          stateSelect.append('<option value="">Select a courses first</option>');
        }
      });
    });

    $(document).ready(function() {
      $('#sel_topics').change(function() {
        var topic_id = $(this).val();
        if (topic_id) {
          $.ajax({
            url: '/load_subtopics/',
            data: {
              'topic_id': topic_id
            },
            dataType: 'json',
            success: function(response) {
              var stateSelect = $('#sel_subtopics');
              stateSelect.empty();
              stateSelect.append('<option value="">---Select the SubTopics---</option>');
              $.each(response.subtopics, function(index, subtopic) {
                stateSelect.append('<option value="' + subtopic.id + '">' + subtopic.id + '-' + subtopic.name + '</option>');
              });
            }
          });
        } else {
          var stateSelect = $('#sel_subtopics');
          stateSelect.empty();
          stateSelect.append('<option value="">Select a topics first</option>');
        }
      });
    });    
</script> -->
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script src="/static/js/underscore-min.js"></script>
<script src="/static/js/lr_bulk.js"></script>
{% endblock %}